require('ggplot2')
require('scales')

error_15_min = c(0.27309236947791166, -0.12449799196787126, 
                 -3.9959839357429718, 0.90361445783132543, 0.21686746987951808, 
                 1.2128514056224899, 0.23694779116465892, 1.9357429718875494, 
                 0.076305220883533309, -4.8152610441767081, -7.6546184738955825, 
                 0.10843373493975861, 1.1686746987951793, 0.048192771084337949, 
                 0.048192771084337949, -0.064257028112450598, 0.0080321285140563248, 
                 -0.012048192771084487, -1.020080321285139, -0.17670682730923737, 
                 -1.1084337349397586, 1.4738955823293161, 3.1646586345381529, 
                 -1.4819277108433735, -8.1646586345381529, 0.51807228915662651, 
                 1.9959839357429718, -1.6666666666666667, 0.43373493975903615, 
                 -3.5823293172690764, 3.4016064257028109, 0.38955823293172687, 
                 1.0803212851405624, 0.73092369477911667, 1.0602409638554218, 
                 -1.0080321285140563, -0.33734939759036209, -2.7670682730923701, 
                 -0.9558232931726911, 0.01606425702811265, -0.036144578313253017, 
                 -0.052208835341366111, -0.9236947791164658, -0.39357429718875458, 
                 -0.20883534136546267, 0.0, 2.7309236947791149, 1.7510040160642575, 
                 3.8514056224899598, 2.0923694779116468, -0.53012048192771077, 
                 -0.12449799196787126, 5.9959839357429718, -6.4698795180722888, 
                 1.2971887550200802, 0.21686746987951722, 0.20080321285140457, 
                 0.30120481927710863, 0.64257028112449888, -4.1847389558232919, 
                 0.37349397590361377, -7.044176706827308, 0.10441767068273222, 
                 -3.0080321285140563, -0.004016064257026386, -2.0, 
                 -4.0843373493975896, 1.7108433734939759, -5.6425702811244989, 
                 1.2088353413654627, -0.060240963855421548, -3.1887550200803219, 
                 -0.02008032128514059, -0.012048192771084487, 0.39759036144578314, 
                 0.93172690763052213, 0.12449799196787126, 2.2610441767068274, 
                 -2.4176706827309236, -2.7068273092369477, 0.46586345381526062, 
                 0.70281124497991954, 1.9116465863453822, -0.2931726907630523, 
                 1.4176706827309253, 0.30923694779116495, -0.20883534136546089, 
                 -0.024096385542168974, -0.0080321285140563248, -0.080321285140563248)

error_30_min = c(0.57429718875502012, 1.0080321285140563, -3.8514056224899598, 1.0642570281124497, 0.48192771084337349, 1.333333333333333, -0.40160642570281091, 4.6184738955823299, 0.25702811244979884, -5.6064257028112436, -11.38152610441767, 1.0, 1.2931726907630505, 1.1124497991967885, 0.076305220883533309, -0.1285140562249012, -0.024096385542168974, 0.91967871485943853, -1.0562248995983943, 2.477911646586346, -0.9357429718875494, 2.7911646586345391, 4.7751004016064265, -0.15261044176706828, -6.9558232931726902, 0.81927710843373491, 2.0, -0.40160642570281124, -1.1807228915662651, -6.4016064257028109, 3.8955823293172687, 2.1405622489959839, 1.8795180722891567, 1.2289156626506017, -8.0722891566265069, -15.0, 0.12048192771084487, -2.570281124497992, -1.8514056224899598, -0.97991967871486096, -0.032128514056224855, -0.12449799196787126, -0.87550200803212852, -0.87550200803212874, -1.3574297188755011, -7.0160642570281126, 2.7510040160642575, 4.4056224899598391, 6.8473895582329316, 3.7469879518072293, 0.86345381526104414, -2.0080321285140563, 7.0642570281124497, -5.072289156626506, 1.8072289156626506, -18.361445783132531, 0.66265060240963791, 0.95180722891566205, 1.0, 0.0, 0.42570281124498166, -7.1204819277108449, 0.11244979919678855, -3.0080321285140563, -0.004016064257026386, -2.0080321285140563, -3.2088353413654609, 2.4016064257028109, -5.6425702811244989, 0.65461847389558159, -0.16064257028112472, -2.522088353413654, -7.7188755020080322, 1.2128514056224899, 0.70281124497991965, 0.89959839357429683, 0.18875502008032186, 1.714859437751004, -3.1606425702811247, -4.3534136546184738, -0.024096385542168974, 0.50200803212851497, 1.546184738955823, -1.0, 1.4819277108433724, 0.57429718875502012, -0.32530120481927582, 1.0361445783132517, -0.076305220883533309, -0.22088353413654715)
error_45_min = c(0.77510040160642568, 1.9236947791164658, -3.7791164658634537, 0.94377510040160661, -1.285140562248996, 3.570281124497992, 0.5542168674698793, 3.8594377510040161, 0.30120481927710863, -6.3654618473895574, -11.200803212851405, 1.0, 1.4819277108433724, 1.0642570281124506, 0.064257028112450598, -0.20080321285140457, 3.0040160642570264, 0.9357429718875494, -1.0803212851405632, -0.072289156626505147, -1.477911646586346, 2.6987951807228932, 3.9799196787148592, 1.1084337349397591, -8.9919678714859437, 1.0401606425702812, 2.0963855421686746, 0.85943775100401609, -0.76305220883534131, -6.0562248995983934, 1.4779116465863451, 2.7871485943775101, 1.606425702811245, 3.2168674698795172, -4.4939759036144578, -14.0, -0.56626506024096557, -2.4738955823293178, -2.8232931726907626, 0.01606425702811265, 0.97991967871485963, -0.19678714859437818, -0.83534136546184734, 0.40160642570281091, -10.333333333333334, -11.333333333333334, 0.2690763052208851, 5.8995983935742977, 9.5983935742971891, 6.7791164658634537, 1.1285140562248996, 0.67068273092369424, 6.1847389558232928, -2.6746987951807228, 2.3614457831325302, -18.112449799196789, -4.4377510040160644, -5.5421686746987948, 1.590361445783131, 0.0, 0.40963855421686901, -7.1646586345381529, 0.052208835341364335, -3.044176706827308, 0.076305220883533309, -1.044176706827308, -2.3654618473895574, 1.7751004016064265, -6.5381526104417667, 0.19277108433735002, -6.1847389558232928, -1.0080321285140563, -5.7510040160642575, 0.10040160642570317, 0.97590361445783136, -0.42168674698795172, -0.63453815261044255, 2.3975903614457832, -2.7590361445783129, -7.7991967871485937, 1.8755020080321287, -0.91967871485943675, 3.3734939759036138, -1.0, 0.49397590361445864, 0.97188755020080286, -0.36144578313253106, 0.98795180722891729, -0.04417670682730801, -0.27710843373494143)
error_60_min = c(0.95582329317269077, 2.6867469879518069, -3.5140562248995986, 1.8634538152610443, 0.068273092369477872, 1.666666666666667, 0.11646586345381493, 4.9156626506024104, 1.4618473895582333, -5.9638554216867483, -9.9156626506024104, 1.0, 0.33333333333333215, 1.2248995983935735, 0.068273092369476984, -0.23293172690762987, 2.9397590361445793, 0.90361445783132588, -1.2409638554216862, -10.441767068273093, -2.6425702811244989, 2.6345381526104426, 5.8795180722891569, 1.3534136546184738, -9.1044176706827304, 0.32530120481927716, 2.9678714859437751, 1.1526104417670682, 0.73493975903614461, -5.6546184738955825, 2.3493975903614457, 3.3132530120481927, 3.0642570281124497, 5.0843373493975896, -2.9718875502008033, -13.0, -2.5622489959839356, -2.4618473895582333, -2.7269076305220885, 0.088353413654619573, -0.088353413654618684, -0.35742971887550112, -0.75100401606425704, -0.37349397590361377, -10.485943775100402, -10.204819277108435, -0.62248995983935629, 8.5783132530120483, 9.5582329317269075, 6.8152610441767072, 0.11646586345381515, 1.7751004016064265, 6.3132530120481931, -1.1445783132530121, 2.4779116465863456, -17.899598393574298, -3.6746987951807242, -12.004016064257028, 3.9357429718875494, 0.0, 0.40562248995983907, -7.3253012048192758, 0.10441767068273222, -3.1004016064257023, 0.9036144578313241, -1.0883534136546196, -1.590361445783131, 3.0682730923694788, -6.5983935742971873, 1.1405622489959839, -8.1927710843373482, 0.50602409638554136, -5.6265060240963853, 0.95983935742971926, 1.1365461847389557, 0.63453815261044166, -0.57429718875502012, 0.82730923694779124, -2.4096385542168672, -8.5863453815261046, -3.2369477911646589, -0.34136546184738847, 3.9839357429718874, -1.0, 0.30923694779116317, 1.0200803212851408, 1.522088353413654, 0.89959839357429772, -0.15662650602409656, -0.39357429718875636)
error_120_min = c(1.3614457831325302, 4.8795180722891569, -2.2208835341365463, 3.3534136546184738, -3.0883534136546187, -0.42168674698795172, 0.78313253012048278, 2.5140562248995977, 1.3935742971887546, -7.1204819277108449, -12.0, 0.0, 0.81927710843373447, 5.3293172690763058, 0.068273092369476984, -0.40160642570281269, 2.9518072289156621, 1.6586345381526097, 1.7108433734939759, -5.2168674698795181, 4.4859437751004023, 7.0883534136546196, -3.3855421686746983, 2.2771084337349397, -7.6666666666666661, 1.6465863453815262, 3.0321285140562249, 1.9116465863453815, 0.79919678714859455, -2.3012048192771086, 8.1244979919678713, 4.333333333333333, 3.9879518072289155, 7.1726907630522092, -9.0, -17.0, -4.7951807228915655, -7.261044176706827, -0.77911646586345373, 0.82329317269076441, -0.27710843373493965, -1.0040160642570282, 0.44979919678714858, -8.3815261044176701, -10.236947791164658, -7.5542168674698793, 5.4738955823293161, 9.7429718875502012, 6.7228915662650603, 6.4257028112449799, -8.3654618473895574, 3.3052208835341368, 5.092369477911646, -5.5863453815261046, 3.0441767068273089, -12.04417670682731, -4.7269076305220885, -8.4377510040160644, 2.0, 0.0, 0.3493975903614448, -7.4578313253012034, 0.12449799196787126, -3.2168674698795172, 1.8514056224899598, -4.3493975903614448, 13.755020080321286, 10.449799196787149, -13.783132530120483, 1.0401606425702816, -6.2530120481927707, 0.70281124497991954, -1.8795180722891565, 2.5943775100401609, 0.6987951807228916, -8.9718875502008029, -0.22891566265060348, -4.9518072289156629, -2.9437751004016066, -5.8112449799196781, 1.6787148594377506, -0.59437751004016093, 2.0, -17.0, 0.24899598393574252, 1.1646586345381529, 1.2208835341365472, 0.71084337349397586, 0.71485943775100225, 1.7309236947791149)

error_15_min_df = data.frame(error_15_min)
error_30_min_df = data.frame(error_30_min)
error_45_min_df = data.frame(error_45_min)
error_60_min_df = data.frame(error_60_min)
error_120_min_df = data.frame(error_120_min)

(plot_15 <- ggplot(error_15_min_df, aes(x=error_15_min)) +
   geom_histogram(fill = '#3DB7E4', aes(y=..count../sum(..count..))) +
   scale_y_continuous(labels=percent) +
   labs(x = "Error for 15 Minute Prediction", y="Percent of Observation")) +
  ggtitle('Error for 15 Minute Prediction')

(plot_30 <- ggplot(error_30_min_df, aes(x=error_30_min)) +
   geom_histogram(fill = '#3DB7E4', aes(y=..count../sum(..count..))) +
   scale_y_continuous(labels=percent) +
   labs(x = "Error for 30 Minute Prediction", y="Percent of Observation")) +
  ggtitle('Error for 30 Minute Prediction')

(plot_45 <- ggplot(error_45_min_df, aes(x=error_45_min)) +
   geom_histogram(fill = '#3DB7E4', aes(y=..count../sum(..count..))) +
   scale_y_continuous(labels=percent) +
   labs(x = "Error for 45 Minute Prediction", y="Percent of Observation")) +
  ggtitle('Error for 45 Minute Prediction')

(plot_60 <- ggplot(error_60_min_df, aes(x=error_60_min)) +
   geom_histogram(fill = '#3DB7E4', aes(y=..count../sum(..count..))) +
   scale_y_continuous(labels=percent) +
   labs(x = "Error for One Hour Prediction", y="Percent of Observation")) +
  ggtitle('Error for One Hour Prediction')

(plot_120 <- ggplot(error_120_min_df, aes(x=error_120_min)) +
   geom_histogram(fill = '#3DB7E4', aes(y=..count../sum(..count..))) +
   scale_y_continuous(labels=percent) +
   labs(x = "Error for Two Hour Prediction", y="Percent of Observation")) +
  ggtitle('Error for Two Hour Prediction')





omy_breaks_max = seq(from = .5, to = max(error_30_min), by = .5)
my_breaks_min = seq(from = 0, to = min(error_30_min), by = -.5)
my_breaks = sort(c(my_breaks_min,my_breaks_max))

par(mfrow = c(2,2))
hist(error_15_min, breaks = c(min(error_15_min)-3, my_breaks, max(error_15_min)+1))
hist(error_30_min, breaks = c(min(error_30_min)-3, my_breaks, max(error_30_min)+1))
hist(error_45_min, breaks = c(min(error_45_min)-3, my_breaks, max(error_45_min)+1))
hist(error_60_min, breaks = c(min(error_60_min)-3, my_breaks, max(error_60_min)+1))
#hist(error_120_min, breaks = c(min(error_120_min)-1,-1, 0, 1, max(error_120_min)+1))
test = c(-1,2,2,2,4,5)
hist(test, breaks = -1:5)

par(mfrow = c(1,1))
error_120_min_pct = error_120_min/25
error_120_min_pct_df = data.frame(error_120_min_pct)
names(error_120_min_pct_df) <- c('Error')
(plot <- ggplot(error_120_min_pct_df, aes(x=Error)) +
  geom_histogram(fill = '#3DB7E4', aes(y=..count../sum(..count..))) +
  scale_y_continuous(labels=percent) +
  labs(x = "Error Percentage for Two Hour Prediction", y="Percent of Observation")) +
  ggtitle('Error for Two Hour Prediction')
  
plot
#hist(error_120_min_pct)
